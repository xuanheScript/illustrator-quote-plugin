<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Illustrator Quote Plugin - Debug</title>
    <style>
      body {
        margin: 0;
        padding: 20px;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
        background-color: #f5f5f5;
      }
      .debug-info {
        background: #e3f2fd;
        padding: 15px;
        border-radius: 4px;
        margin-bottom: 20px;
        border-left: 4px solid #2196f3;
      }
      .plugin-container {
        max-width: 320px;
        border: 1px solid #ddd;
        border-radius: 4px;
        background: white;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
    </style>
  </head>
  <body>
    <div class="debug-info">
      <h2>ğŸ”§ è°ƒè¯•æ¨¡å¼</h2>
      <p>è¿™æ˜¯æ’ä»¶çš„æµè§ˆå™¨è°ƒè¯•ç‰ˆæœ¬ã€‚åœ¨å®é™…çš„ CEP ç¯å¢ƒä¸­ï¼ŒCSInterface å°†å¯ç”¨ã€‚</p>
      <p><strong>æ³¨æ„ï¼š</strong>åœ¨æµè§ˆå™¨ä¸­ï¼ŒExtendScript è°ƒç”¨å°†è¢«æ¨¡æ‹Ÿã€‚</p>
    </div>

    <div class="plugin-container">
      <div id="root">
        <div style="display: flex; justify-content: center; align-items: center; height: 400px; font-size: 14px; color: #666;">
          æ­£åœ¨åŠ è½½æ’ä»¶...
        </div>
      </div>
    </div>

    <!-- æ¨¡æ‹Ÿ CSInterface -->
    <script>
      // æ¨¡æ‹Ÿ CSInterface ç”¨äºæµè§ˆå™¨è°ƒè¯•
      window.CSInterface = function() {
        this.hostEnvironment = {
          appName: "ILST",
          appVersion: "25.0.0"
        };
      };

      window.CSInterface.prototype.getHostEnvironment = function() {
        return JSON.stringify(this.hostEnvironment);
      };

      window.CSInterface.prototype.evalScript = function(script, callback) {
        console.log("ğŸ”§ æ¨¡æ‹Ÿ ExtendScript è°ƒç”¨:", script);
        
        // æ¨¡æ‹Ÿä¸åŒçš„å“åº”
        setTimeout(function() {
          if (callback) {
            if (script.includes('applyMaterial')) {
              callback(JSON.stringify({
                success: true,
                message: "æ¨¡æ‹Ÿï¼šæˆåŠŸåº”ç”¨æè´¨åˆ° 1 ä¸ªå¯¹è±¡",
                data: [{
                  name: "æµ‹è¯•å¯¹è±¡",
                  material: "äºšå…‹åŠ›",
                  area: "2.500",
                  unitPrice: 200,
                  totalPrice: "500.00"
                }]
              }));
            } else if (script.includes('exportQuote')) {
              callback(JSON.stringify({
                success: true,
                message: "æ¨¡æ‹Ÿï¼šæŠ¥ä»·å•å·²å¯¼å‡ºåˆ°æ¡Œé¢: æŠ¥ä»·å•_20241225_1430.csv",
                data: {
                  itemCount: 1,
                  totalAmount: "500.00",
                  filePath: "/Users/Desktop/æŠ¥ä»·å•_20241225_1430.csv"
                }
              }));
            } else {
              callback("æ¨¡æ‹Ÿè„šæœ¬æ‰§è¡Œå®Œæˆ");
            }
          }
        }, 500);
      };

      console.log("ğŸ”§ CSInterface æ¨¡æ‹Ÿå™¨å·²åŠ è½½");
    </script>

    <!-- åŠ è½½æ„å»ºåçš„æ’ä»¶ -->
    <script src="./dist/assets/index.js"></script>
  </body>
</html> 